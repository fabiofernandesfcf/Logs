<!doctype html>
<html lang="pt-PT">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Simulador de Logs</title>
<style>
  :root{
    --bg:#0b1020;
    --panel:#071021;
    --text:#cfe8ff;
    --muted:#7ea6c8;
    --accent:#4ee28a;
    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#071021);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--text)}
  .wrap{max-width:1000px;margin:32px auto;padding:20px}
  .card{
    background:linear-gradient(180deg,var(--panel),#071827);
    border-radius:10px;padding:18px;
    box-shadow:0 6px 30px rgba(2,6,14,0.6);
    border:1px solid rgba(255,255,255,0.03);
  }
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  h1{font-size:18px;margin:0;color:var(--text)}
  .sub{font-size:13px;color:var(--muted)}
  .terminal{
    background:#000814;
    border-radius:8px;padding:12px 14px;height:480px;overflow:auto;
    font-family:var(--mono);font-size:13px;line-height:1.4;color:var(--text);
    box-sizing:border-box;border:1px solid rgba(255,255,255,0.03);
  }
  .line{white-space:pre-wrap;display:block}
  .ts{color:var(--muted);margin-right:8px}
  .lvl-info{color:#7cc7ff}
  .lvl-warn{color:#ffd36b}
  .lvl-err{color:#ff7b7b}
  .controls{margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  button{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:8px 10px;border-radius:8px;cursor:pointer}
  button.primary{background:linear-gradient(90deg,#1b5bff,#3bd6a5);color:#021018;border:none}
  label{font-size:13px;color:var(--muted)}
  input[type=range]{width:140px}
  .footer{font-size:12px;color:var(--muted);margin-top:10px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <header>
      <div>
        <h1>LOGS OCPIXPTO</h1>
       
      </div>
      <div class="sub">Status: <strong id="status">Running</strong></div>
    </header>

    <div id="terminal" class="terminal" aria-live="polite"></div>

    <div class="controls">
      <button id="btnPause">Pausar</button>
      <button id="btnClear">Limpar</button>
      <button class="primary" id="btnOne">Adicionar 1 linha</button>

      <label>Velocidade (ms entre linhas)
        <input id="speed" type="range" min="200" max="2000" step="100" value="800">
        <span id="spdVal">800</span>
      </label>

      <label>Tipo de conteúdo:
        <select id="mode">
          <option value="random">Aleatório</option>
          <option value="cycle">Cíclico (array)</option>
          <option value="timestamp">Apenas timestamps</option>
        </select>
      </label>
    </div>

    <div class="footer"></div>
  </div>
</div>

<script>
/*
  Simulador de logs simples:
  - Edita 'sampleLogs' para as tuas linhas reais.
  - Modos:
    - random: escolhe aleatoriamente das mensagens
    - cycle: percorre o array em loop
    - timestamp: só escreve timestamps
  - Deploy no GitHub Pages: coloca este ficheiro no repo e ativa Pages.
*/

const terminal = document.getElementById('terminal');
const btnPause = document.getElementById('btnPause');
const btnClear = document.getElementById('btnClear');
const btnOne = document.getElementById('btnOne');
const speedInput = document.getElementById('speed');
const spdVal = document.getElementById('spdVal');
const statusEl = document.getElementById('status');
const modeSelect = document.getElementById('mode');

let running = true;
let idx = 0;
let timer = null;
let speed = +speedInput.value;

  const sampleLogs = [
  { lvl: 'INFO', msg: 'STATION_STATUS: ID=CS101, Location="Lisbon", Status=Online, AvailableConnectors=4' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U201, StationID=CS101, ConnectorID=C1, StartTime=07:55, TariffID=T10' },
  { lvl: 'INFO', msg: 'SESSION_UPDATE: SessionID=S501, EnergyDelivered=4.5kWh, Status=Charging' },
  { lvl: 'ERROR', msg: 'SESSION_ALERT: SessionID=S502, Status=Interrupted, Reason=PaymentFailed' },
  { lvl: 'INFO', msg: 'STATION_STATUS: ID=CS102, Location="Lisbon", Status=Online, AvailableConnectors=3' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U204, StationID=CS102, ConnectorID=C1, StartTime=08:10, TariffID=T12' },
  { lvl: 'INFO', msg: 'SESSION_UPDATE: SessionID=S501, EnergyDelivered=5.2kWh, Status=Charging' },
  { lvl: 'ERROR', msg: 'SESSION_ALERT: SessionID=S503, Status=Interrupted, Reason=Overcurrent' },
  { lvl: 'WARN', msg: 'TARIFF_UPDATE: TariffID=T12, NewRate=0.35€/kWh' },
  { lvl: 'INFO', msg: 'SESSION_END: SessionID=S501, EnergyDelivered=12.5kWh, Cost=4.375€' },
  { lvl: 'WARN', msg: 'STATION_STATUS: ID=CS103, Location="Porto", Status=Maintenance, AvailableConnectors=0' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U205, StationID=CS103, ConnectorID=C2, StartTime=08:28, TariffID=T15' },
  { lvl: 'INFO', msg: 'SESSION_END: SessionID=S503, EnergyDelivered=8.0kWh, Cost=2.4€' },
  { lvl: 'WARN', msg: 'USER_ALERT: UserID=U205, Message="Session failed, station under maintenance"' },
  { lvl: 'INFO', msg: 'STATION_STATUS: ID=CS104, Location="Lisbon", Status=Online, AvailableConnectors=2' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U206, StationID=CS104, ConnectorID=C1, StartTime=08:38, TariffID=T12' },
  { lvl: 'INFO', msg: 'SESSION_UPDATE: SessionID=S504, EnergyDelivered=3.5kWh, Status=Charging' },
  { lvl: 'INFO', msg: 'SESSION_END: SessionID=S504, EnergyDelivered=7.0kWh, Cost=2.45€' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U207, StationID=CS101, ConnectorID=C2, StartTime=08:47, TariffID=T10' },
  { lvl: 'INFO', msg: 'SESSION_UPDATE: SessionID=S505, EnergyDelivered=2.0kWh, Status=Charging' },
  { lvl: 'INFO', msg: 'SESSION_END: SessionID=S505, EnergyDelivered=6.0kWh, Cost=1.8€' },
  { lvl: 'INFO', msg: 'STATION_STATUS: ID=CS105, Location="Coimbra", Status=Online, AvailableConnectors=1' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U208, StationID=CS105, ConnectorID=C1, StartTime=09:00, TariffID=T18' },
  { lvl: 'ERROR', msg: 'SESSION_ALERT: SessionID=S506, Status=Interrupted, Reason=HardwareFailure' },
  { lvl: 'WARN', msg: 'TARIFF_UPDATE: TariffID=T18, NewRate=0.40€/kWh' },
  { lvl: 'INFO', msg: 'SESSION_END: SessionID=S506, EnergyDelivered=3.0kWh, Cost=1.2€' },
  { lvl: 'INFO', msg: 'STATION_STATUS: ID=CS102, Location="Lisbon", Status=Online, AvailableConnectors=2' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U209, StationID=CS102, ConnectorID=C2, StartTime=09:18, TariffID=T12' },
  { lvl: 'INFO', msg: 'SESSION_UPDATE: SessionID=S507, EnergyDelivered=4.0kWh, Status=Charging' },
  { lvl: 'INFO', msg: 'SESSION_END: SessionID=S507, EnergyDelivered=9.0kWh, Cost=3.15€' },
  { lvl: 'WARN', msg: 'USER_ALERT: UserID=U209, Message="Charging completed successfully"' },
  { lvl: 'INFO', msg: 'STATION_STATUS: ID=CS103, Location="Porto", Status=Online, AvailableConnectors=2' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U210, StationID=CS103, ConnectorID=C1, StartTime=09:35, TariffID=T15' },
  { lvl: 'INFO', msg: 'SESSION_UPDATE: SessionID=S508, EnergyDelivered=5.5kWh, Status=Charging' },
  { lvl: 'INFO', msg: 'SESSION_END: SessionID=S508, EnergyDelivered=11.0kWh, Cost=3.3€' },
  { lvl: 'WARN', msg: 'STATION_STATUS: ID=CS104, Location="Lisbon", Status=Maintenance, AvailableConnectors=0' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U211, StationID=CS104, ConnectorID=C1, StartTime=09:50, TariffID=T12' },
  { lvl: 'ERROR', msg: 'SESSION_ALERT: SessionID=S509, Status=Interrupted, Reason=StationOffline' },
  { lvl: 'WARN', msg: 'USER_ALERT: UserID=U211, Message="Charging session interrupted due to maintenance"' },
  { lvl: 'INFO', msg: 'STATION_STATUS: ID=CS105, Location="Coimbra", Status=Online, AvailableConnectors=1' },
  { lvl: 'INFO', msg: 'SESSION_START: UserID=U212, StationID=CS105, ConnectorID=C1, StartTime=10:05, TariffID=T18' },
  { lvl: 'INFO', msg: 'SESSION_UPDATE: SessionID=S510, EnergyDelivered=2.5kWh, Status=Charging' },
  { lvl: 'INFO', msg: 'SESSION_END: SessionID=S510, EnergyDelivered=5.0kWh, Cost=2.0€' },
];



// Utilitário timestamp
function ts() {
  return new Date().toLocaleString();
}

// Cria uma linha com "tipo" de cor por nível
function formatLine(obj) {
  const time = `<span class="ts">[${ts()}]</span>`;
  const lvlClass = obj.lvl === 'ERROR' ? 'lvl-err' : (obj.lvl === 'WARN' ? 'lvl-warn' : 'lvl-info');
  const lvl = `<span class="${lvlClass}">[${obj.lvl}]</span>`;
  const msg = `<span class="msg">${escapeHtml(obj.msg)}</span>`;
  return `${time}${lvl} ${msg}`;
}

// Segurança mínima para evitar XSS se personalizares mensagens
function escapeHtml(s){
  return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]));
}

// Append e scroll auto
function appendLine(html) {
  const div = document.createElement('div');
  div.className = 'line';
  div.innerHTML = html;
  terminal.appendChild(div);
  // manter só as últimas 500 linhas para não estourar memória
  if (terminal.children.length > 500) terminal.removeChild(terminal.children[0]);
  terminal.scrollTop = terminal.scrollHeight;
}

// Gera próxima linha segundo modo
function nextLog() {
  const mode = modeSelect.value;
  if (mode === 'timestamp') {
    appendLine(`<span class="ts">[${ts()}]</span> <span class="lvl-info">[INFO]</span> Heartbeat`);
    return;
  }
  let item;
  if (mode === 'random') {
    item = sampleLogs[Math.floor(Math.random() * sampleLogs.length)];
  } else { // cycle
    item = sampleLogs[idx % sampleLogs.length];
    idx++;
  }
  appendLine(formatLine(item));
}

// Loop principal
function startLoop() {
  if (timer) clearInterval(timer);
  timer = setInterval(() => {
    if (running) nextLog();
  }, speed);
  statusEl.textContent = running ? 'Running' : 'Paused';
}

btnPause.addEventListener('click', () => {
  running = !running;
  btnPause.textContent = running ? 'Pausar' : 'Retomar';
  statusEl.textContent = running ? 'Running' : 'Paused';
});

btnClear.addEventListener('click', () => {
  terminal.innerHTML = '';
});

btnOne.addEventListener('click', () => {
  nextLog();
});

speedInput.addEventListener('input', (e) => {
  speed = +e.target.value;
  spdVal.textContent = speed;
  startLoop();
});

modeSelect.addEventListener('change', () => {
  // reset index if cycling
  if (modeSelect.value === 'cycle') idx = 0;
});

// Pequeno efeito inicial: escrever algumas linhas
appendLine(`<span class="ts">[${ts()}]</span> <span class="lvl-info">[INFO]</span> Log simulator ready.`);
startLoop();
</script>
</body>
</html>
