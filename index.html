<!doctype html>
<html lang="pt-PT">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Simulador de Logs</title>
<style>
  :root{
    --bg:#0b1020;
    --panel:#071021;
    --text:#cfe8ff;
    --muted:#7ea6c8;
    --accent:#4ee28a;
    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#071021);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--text)}
  .wrap{max-width:1000px;margin:32px auto;padding:20px}
  .card{
    background:linear-gradient(180deg,var(--panel),#071827);
    border-radius:10px;padding:18px;
    box-shadow:0 6px 30px rgba(2,6,14,0.6);
    border:1px solid rgba(255,255,255,0.03);
  }
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  h1{font-size:18px;margin:0;color:var(--text)}
  .sub{font-size:13px;color:var(--muted)}
  .terminal{
    background:#000814;
    border-radius:8px;padding:12px 14px;height:480px;overflow:auto;
    font-family:var(--mono);font-size:13px;line-height:1.4;color:var(--text);
    box-sizing:border-box;border:1px solid rgba(255,255,255,0.03);
  }
  .line{white-space:pre-wrap;display:block}
  .ts{color:var(--muted);margin-right:8px}
  .lvl-info{color:#7cc7ff}
  .lvl-warn{color:#ffd36b}
  .lvl-err{color:#ff7b7b}
  .controls{margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  button{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:8px 10px;border-radius:8px;cursor:pointer}
  button.primary{background:linear-gradient(90deg,#1b5bff,#3bd6a5);color:#021018;border:none}
  label{font-size:13px;color:var(--muted)}
  input[type=range]{width:140px}
  .footer{font-size:12px;color:var(--muted);margin-top:10px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <header>
      <div>
        <h1>Simulador de Logs — Página de demonstração</h1>
        <div class="sub">Simula linhas de logs a aparecer ciclicamente. Deploy fácil com GitHub Pages.</div>
      </div>
      <div class="sub">Status: <strong id="status">Running</strong></div>
    </header>

    <div id="terminal" class="terminal" aria-live="polite"></div>

    <div class="controls">
      <button id="btnPause">Pausar</button>
      <button id="btnClear">Limpar</button>
      <button class="primary" id="btnOne">Adicionar 1 linha</button>

      <label>Velocidade (ms entre linhas)
        <input id="speed" type="range" min="200" max="2000" step="100" value="800">
        <span id="spdVal">800</span>
      </label>

      <label>Tipo de conteúdo:
        <select id="mode">
          <option value="random">Aleatório</option>
          <option value="cycle">Cíclico (array)</option>
          <option value="timestamp">Apenas timestamps</option>
        </select>
      </label>
    </div>

    <div class="footer">Dica: Personaliza o array <code>sampleLogs</code> no script para as mensagens que preferires.</div>
  </div>
</div>

<script>
/*
  Simulador de logs simples:
  - Edita 'sampleLogs' para as tuas linhas reais.
  - Modos:
    - random: escolhe aleatoriamente das mensagens
    - cycle: percorre o array em loop
    - timestamp: só escreve timestamps
  - Deploy no GitHub Pages: coloca este ficheiro no repo e ativa Pages.
*/

const terminal = document.getElementById('terminal');
const btnPause = document.getElementById('btnPause');
const btnClear = document.getElementById('btnClear');
const btnOne = document.getElementById('btnOne');
const speedInput = document.getElementById('speed');
const spdVal = document.getElementById('spdVal');
const statusEl = document.getElementById('status');
const modeSelect = document.getElementById('mode');

let running = true;
let idx = 0;
let timer = null;
let speed = +speedInput.value;

// Exemplo de logs que tínhamos / queres -> personaliza
const sampleLogs = [
  {lvl:'INFO', msg:'Starting background jobs...'},
  {lvl:'INFO', msg:'Connected to DB replica: db-prod-1'},
  {lvl:'WARN', msg:'High memory usage detected: 84%'},
  {lvl:'INFO', msg:'New websocket connection from 10.0.2.14'},
  {lvl:'ERROR', msg:'Failed to push metrics: timeout'},
  {lvl:'INFO', msg:'Deployment v1.3.7 started'},
  {lvl:'INFO', msg:'Cache miss for key: user_1245'},
  {lvl:'INFO', msg:'Worker #3 completed task #4551'},
  {lvl:'WARN', msg:'TLS certificate expires in 7 days'},
  {lvl:'INFO', msg:'Processed 214 events in 5s'},
];

// Utilitário timestamp
function ts() {
  return new Date().toLocaleString();
}

// Cria uma linha com "tipo" de cor por nível
function formatLine(obj) {
  const time = `<span class="ts">[${ts()}]</span>`;
  const lvlClass = obj.lvl === 'ERROR' ? 'lvl-err' : (obj.lvl === 'WARN' ? 'lvl-warn' : 'lvl-info');
  const lvl = `<span class="${lvlClass}">[${obj.lvl}]</span>`;
  const msg = `<span class="msg">${escapeHtml(obj.msg)}</span>`;
  return `${time}${lvl} ${msg}`;
}

// Segurança mínima para evitar XSS se personalizares mensagens
function escapeHtml(s){
  return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]));
}

// Append e scroll auto
function appendLine(html) {
  const div = document.createElement('div');
  div.className = 'line';
  div.innerHTML = html;
  terminal.appendChild(div);
  // manter só as últimas 500 linhas para não estourar memória
  if (terminal.children.length > 500) terminal.removeChild(terminal.children[0]);
  terminal.scrollTop = terminal.scrollHeight;
}

// Gera próxima linha segundo modo
function nextLog() {
  const mode = modeSelect.value;
  if (mode === 'timestamp') {
    appendLine(`<span class="ts">[${ts()}]</span> <span class="lvl-info">[INFO]</span> Heartbeat`);
    return;
  }
  let item;
  if (mode === 'random') {
    item = sampleLogs[Math.floor(Math.random() * sampleLogs.length)];
  } else { // cycle
    item = sampleLogs[idx % sampleLogs.length];
    idx++;
  }
  appendLine(formatLine(item));
}

// Loop principal
function startLoop() {
  if (timer) clearInterval(timer);
  timer = setInterval(() => {
    if (running) nextLog();
  }, speed);
  statusEl.textContent = running ? 'Running' : 'Paused';
}

btnPause.addEventListener('click', () => {
  running = !running;
  btnPause.textContent = running ? 'Pausar' : 'Retomar';
  statusEl.textContent = running ? 'Running' : 'Paused';
});

btnClear.addEventListener('click', () => {
  terminal.innerHTML = '';
});

btnOne.addEventListener('click', () => {
  nextLog();
});

speedInput.addEventListener('input', (e) => {
  speed = +e.target.value;
  spdVal.textContent = speed;
  startLoop();
});

modeSelect.addEventListener('change', () => {
  // reset index if cycling
  if (modeSelect.value === 'cycle') idx = 0;
});

// Pequeno efeito inicial: escrever algumas linhas
appendLine(`<span class="ts">[${ts()}]</span> <span class="lvl-info">[INFO]</span> Log simulator ready.`);
startLoop();
</script>
</body>
</html>
